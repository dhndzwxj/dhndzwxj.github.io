<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><!-- hexo injector head_begin start -->
<link rel="stylesheet" href="css/bilicard.css">
<!-- hexo injector head_begin end --><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>空间计量经济学与stata实操 | 小荷才露尖尖角</title><meta name="author" content="揭晓"><meta name="copyright" content="揭晓"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="参考了南京大学某位网友的视频。此外，山东大学陈强教授的《高级计量经济学及Stata应用》第29章的相关内容对本文也有很大帮助。   1. 空间计量经济学概述  地理学第一定律：所有事物都与其他事物相关，但较近的事物比较远的事物更关联(Tobler, 1970)。 空间计量经济学诞生于20世纪70年代，近年来，空间计量经济学蓬勃发展并进入主流。其归因于两方面，第一，由于GIS的发展，空间数据或包含">
<meta property="og:type" content="article">
<meta property="og:title" content="空间计量经济学与stata实操">
<meta property="og:url" content="https://dhndzwxj.github.io/1302782253.html">
<meta property="og:site_name" content="小荷才露尖尖角">
<meta property="og:description" content="参考了南京大学某位网友的视频。此外，山东大学陈强教授的《高级计量经济学及Stata应用》第29章的相关内容对本文也有很大帮助。   1. 空间计量经济学概述  地理学第一定律：所有事物都与其他事物相关，但较近的事物比较远的事物更关联(Tobler, 1970)。 空间计量经济学诞生于20世纪70年代，近年来，空间计量经济学蓬勃发展并进入主流。其归因于两方面，第一，由于GIS的发展，空间数据或包含">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dhndzwxj.github.io/private_img/banner2.gif">
<meta property="article:published_time" content="2022-11-10T06:16:51.000Z">
<meta property="article:modified_time" content="2023-03-07T10:32:10.835Z">
<meta property="article:author" content="揭晓">
<meta property="article:tag" content="stata">
<meta property="article:tag" content="空间计量">
<meta property="article:tag" content="空间权重矩阵">
<meta property="article:tag" content="空间自相关检验">
<meta property="article:tag" content="SAR">
<meta property="article:tag" content="SEM">
<meta property="article:tag" content="SDM">
<meta property="article:tag" content="SARAR">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dhndzwxj.github.io/private_img/banner2.gif"><link rel="shortcut icon" href="/private_img/favicon.png"><link rel="canonical" href="https://dhndzwxj.github.io/1302782253.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: {"limitDay":50,"position":"top","messagePrev":"本文上次更新距离今天已经过去","messageNext":"天, 文中内容可能已经过时，望周知。"},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '空间计量经济学与stata实操',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-07 18:32:10'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.loli.net/css2?family=Noto+Serif+SC:wght@400;500;700&display=swap" rel="stylesheet"><link href="https://fonts.loli.net/css2?family=Ma+Shan+Zheng:wght@400;500;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="/css/wave.css?v1"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="atom.xml" title="小荷才露尖尖角" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="../private_img/yuyingnan.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="../archives/"><div class="headline">文章</div><div class="length-num">297</div></a><a href="../tags/"><div class="headline">标签</div><div class="length-num">669</div></a><a href="/"><div class="headline">分类</div><div class="length-num">77</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="../../../"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="../about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-laptop-house"></i><span> 结构</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="../categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></li><li><a class="site-page child" href="../archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="../tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="../air-conditioner/"><i class="fa-fw fas fa-wind"></i><span> 便携小空调</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/private_img/banner2.gif')"><nav id="nav"><span id="blog-info"><a href="../index.html" title="小荷才露尖尖角"><span class="site-name">小荷才露尖尖角</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="../../../"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="../about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-laptop-house"></i><span> 结构</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="../categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></li><li><a class="site-page child" href="../archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="../tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="../air-conditioner/"><i class="fa-fw fas fa-wind"></i><span> 便携小空调</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">空间计量经济学与stata实操</h1><div id="post-meta"><div class="meta-firstline"><i class="fa-solid fa-user"></i><span class="post-meta-author">揭晓</span><span class="post-meta-date"><span class="post-meta-separator">|</span><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-11-10T06:16:51.000Z" title="发表于 2022-11-10 14:16:51">2022-11-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-07T10:32:10.835Z" title="更新于 2023-03-07 18:32:10">2023-03-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="categories/%E8%AE%A1%E9%87%8F%E4%B8%8E%E6%A8%A1%E5%9E%8B/">计量与模型</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="categories/%E8%AE%A1%E9%87%8F%E4%B8%8E%E6%A8%A1%E5%9E%8B/%E8%AE%A1%E9%87%8F/">计量</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="categories/%E8%AE%A1%E9%87%8F%E4%B8%8E%E6%A8%A1%E5%9E%8B/%E8%AE%A1%E9%87%8F/%E7%A9%BA%E9%97%B4%E8%AE%A1%E9%87%8F/">空间计量</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="空间计量经济学与stata实操"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>参考了南京大学某位网友的<a href='https://www.bilibili.com/video/BV1VX4y1A7RK?vd_source=2caa6f7e9f66775e247b05f0ea774ffe' target='_blank'>视频</a>。此外，山东大学陈强教授的《高级计量经济学及Stata应用》第29章的相关内容对本文也有很大帮助。</p>
</blockquote>
<h2 id="1-空间计量经济学概述"><a class="markdownIt-Anchor" href="#1-空间计量经济学概述"></a> 1. 空间计量经济学概述</h2>
<ul>
<li>地理学第一定律：<b>所有事物都与其他事物相关，但较近的事物比较远的事物更关联</b>(Tobler, 1970)。</li>
<li>空间计量经济学诞生于20世纪70年代，近年来，空间计量经济学蓬勃发展并进入主流。其归因于两方面，第一，由于GIS的发展，空间数据或包含地理信息的数据日益增多;第二，在经济理论方面，人们越来越关注经济行为人之间的互动，而不是仅停留于代表性厂商和个人。</li>
<li>所谓空间数据，就是在原来的横截面或面板数据上，加上横截面单位的<b>位置信息(或相互距离)</b>。研究如何处理空间数据的计量经济学分支，称为“空间计量经济学”。空间计量经济学的最大特色在于<b>充分考虑横截面单位之间的空间依赖性</b>。</li>
<li>空间相关性，也称空间依赖性，<b>是指不同区域的事物和现象之间在空间上的互相依赖、互相制约、互相影响和互相作用，是事物和现象本身固有的空间经济属性，是地理空间现象和空间过程的本质属性</b>。</li>
<li>空间依赖可以定义为观测值及区位之间的依赖性。当相邻区域特征变量的高值或低值在空间上呈现集聚倾向时为正的空间自相关，反之，当相邻区域特征变量取值与本区域变量取值高低相反时则为负的空间自相关。</li>
</ul>
<p>空间相关性产生的原因：</p>
<ul>
<li><b>观测数据地理位置临近</b>：由于地理位置的接近而导致的空间相关性是空间相关性最初始的定义，与地理学第一定律吻合。这种相关性是环境、地质等学科中的普遍现象。</li>
<li><b>截面层面个体的相互竞争与合作</b>:最典型的例子是在一个寡头竞争的市场中，厂商对自己产品定价时将同时对市场上其他厂商的价格作出反应，最后决定的价格将是博弈的均衡点。</li>
<li><b>模仿行为</b>:在一群体中，个体会重复或模仿一个或几个特定个体的行为。例如，在班级中，差学生会向好学生学习，模仿他们的学习惯。</li>
<li><b>溢出效应</b>:溢出效应是指经济活动和过程中的外部性对未参与经济活动和过程其中的周围个体的影响。散发有毒气体的植物会对周围的植物产生有害的影响，屋主拥有一座漂亮花园也显然对周围邻居有正效应。同样不断加强的贸易往来所带来的经济利益对地区性国家多边联盟的形成具有正的溢出效应。</li>
<li><b>测量误差</b>:A、B、C三处的观测本来是相互独立的，但是研究者由于无法准确识别A、B和B、C相邻的边界，而将整个区域分成两个部分I和II，在图中用两中颜色表示。显然，由于I和II共享B，所以有理由相信，I和II上的观测值是空间相关的。</li>
</ul>
<div align='center'>
  <img src='/../../images/%E7%A9%BA%E9%97%B4%E8%AE%A1%E9%87%8F%E7%BB%8F%E6%B5%8E%E5%AD%A6%E4%B8%8Estata%E5%AE%9E%E6%93%8D/image-20221110142534682.png' width=400px>
</div>
<h2 id="2-空间权重矩阵的设定与选择"><a class="markdownIt-Anchor" href="#2-空间权重矩阵的设定与选择"></a> 2. 空间权重矩阵的设定与选择</h2>
<p>在实际构建模型时，如何将经济变量的空间效应（空间相关性）纳入回归方程中，需要根据某种标准建立空间权重矩阵。</p>
\begin{eqnarray}
	W = \left(
	\begin{matrix}
		w_{11} & \cdots & w_{1n}\\
		\vdots & & \vdots \\
		w_{n1} & \cdots & w_{nn}
	\end{matrix}
	\right) \notag
\end{eqnarray}

<p>定义空间权重，首先要对空间单元的位置进行量化。对位置的量化一般依据<b>“距离”</b>而定，距离的设定必须满足有意义、有限性和非负性。目前，通常采用的距离有<u>邻接距离、地理距离、经济距离、产业距离和技术距离</u>。其中，最常用的距离是<b>地理距离与经济距离</b>。</p>
<h3 id="21-邻近关系"><a class="markdownIt-Anchor" href="#21-邻近关系"></a> 2.1 邻近关系</h3>
<p>在地图上的 $ n $ 个子区域中，如果区域 $ i $ 和区域 $ j $ 具有相邻的边界（boundary），则定义 $W _ { n,ij }=1 $ ， 否则 $ W _ { n,ij } = 0 $ 。</p>
<ul>
<li>车相邻：两个相邻的区域有共同的边。</li>
<li>象相邻：两个相邻的区域有共同的顶点，但没有共同的边。</li>
<li>后相邻：两个相邻的区域有共同的顶点或共同的边。</li>
</ul>
<div align='center'>
  <img src='/../../images/%E7%A9%BA%E9%97%B4%E8%AE%A1%E9%87%8F%E7%BB%8F%E6%B5%8E%E5%AD%A6%E4%B8%8Estata%E5%AE%9E%E6%93%8D/image-20221110160202044.png' width=400px>
</div>
<p>二元邻近矩阵构建的例子：（车相邻为例）</p>
<div align='center'>
  <img src='/../../images/%E7%A9%BA%E9%97%B4%E8%AE%A1%E9%87%8F%E7%BB%8F%E6%B5%8E%E5%AD%A6%E4%B8%8Estata%E5%AE%9E%E6%93%8D/image-20221110160323312.png' width=300px>
</div>
\begin{eqnarray}
	W_{ij} = \left(
	\begin{matrix}
		0 & 1 & 1 & 1 & 0 & 0 \\
		1 & 0 & 1 & 0 & 0 & 0 \\
		1 & 1 & 0 & 0 & 1 & 1 \\
		1 & 0 & 0 & 0 & 1 & 0 \\
		0 & 0 & 1 & 1 & 0 & 1 \\
		0 & 0 & 1 & 0 & 1 & 0
	\end{matrix}
	\right) \notag
\end{eqnarray}

<h3 id="22-地理距离"><a class="markdownIt-Anchor" href="#22-地理距离"></a> 2.2 地理距离</h3>
<p>地理距离指根据空间地理位置坐标计算的两区域间的欧氏距离，一般是根据区域的<b>质心坐标</b>进行计算。实际操作会将权重设定为距离的倒数:</p>
\begin{eqnarray}
	W_{ij} = d_{ij};   W_{ij}=\frac{1}{d_{ij}}	\notag
\end{eqnarray}

<p>由于空间距离的设定一直存在争议，Pace（1997)提出了有限距离的设定，即以<b>距离阈值</b>设定权重（在阈值范围内取1，在阈值范围外取0）</p>
\begin{eqnarray}
	W_{ij}(d) = \left\{ 
	\begin{matrix}
		1 & \text{当区域}i\text{和区域}j\text{在距离}d\text{之内}(\text{即区域}i\text{区域}j\text{相邻}) \\
		0 & \text{当区域}i\text{和区域}j\text{在距离}d\text{之外}(\text{即区域}i\text{区域}j\text{不相邻})
	\end{matrix}
	\right.	\notag
\end{eqnarray}

<h3 id="23-经济距离"><a class="markdownIt-Anchor" href="#23-经济距离"></a> 2.3 经济距离</h3>
<p>通过可以刻画经济发展水平的指标，通过指标的差值来确定区域之间的经济距离(一般取人均GDP这个指标)。</p>
<p>经济距离指以运费、时间、便利程度（或舒适程度）来表示的两地之间的距离。经济距离主要受交通运输技术进步和设施改善的影响而变化。经济距离的度量可以仿照欧氏距离进行计算，即知道某项经济指标，衡量两区域之间的经济距离时，可以计算两区域经济指标的差值。</p>
\begin{eqnarray}
	W_{ij} = |z_i - z_j|;   W_{ij}=\frac{1}{|z_i - z_j|}	\notag
\end{eqnarray}

<h3 id="24-产业距离"><a class="markdownIt-Anchor" href="#24-产业距离"></a> 2.4 产业距离</h3>
<p>产业是具有某种同类属性经济活动的集合或系统，产业距离表示两种产业之间的相似程度，即产业距离越大，产业之间的相似程度越小：产业距离越小，产业之间的相似程度越大。<u>其具体测算方法与经济距离类似</u>。</p>
<h3 id="25-技术距离比较复杂"><a class="markdownIt-Anchor" href="#25-技术距离比较复杂"></a> 2.5 技术距离（比较复杂）</h3>
<p>Jaffe在1986年提出技术距离的概念，表示两地区之间技术水平之间的相似程度。</p>
\begin{eqnarray}
	Tec_{ij} = \frac{F_i F_j^\prime}{[(F_i F_i^\prime)(F_j F_j^\prime)]^\frac12}
  = \frac{\sum_{k=1}^n f_{ik}f_{jk}}{\sqrt{\sum_{i=1}^n f_{ik}^2\sum_{j=1}^n f_{jk}^2}}
  \notag
\end{eqnarray}

<p>如果该数数值趋近于1，则表示两地之间的技术结构相似，技术距离越近：如果该数值趋近于0，则相反。</p>
<h3 id="26-综合距离"><a class="markdownIt-Anchor" href="#26-综合距离"></a> 2.6 综合距离</h3>
<p>对空间单元的位置进行量化通常可以采用邻接距离、地理距离、经济距离、产业距离和技术距离等，选择的距离形式不同，对于空间相似性的度量结果也会存在不同。因此，<b>采用单个距离指标对空间单元的位置进行量化，构造空间权重矩阵，不能全面衡量空间相关性</b>。</p>
<p>基于此，根据研究问题的不同，我们可以按照<b>相对重要程度</b>对各距离进行<b>加权</b>平均处理，以此得到综合距离。</p>
\begin{eqnarray}
	W(\varphi_1,\varphi_2) = \varphi_1 W^C + (1-\varphi_1)\varphi_2 W^D + (1-\varphi_1)(1-\varphi_2)W^E	\notag
\end{eqnarray}

<h3 id="27-如何选择合适的空间权重矩阵"><a class="markdownIt-Anchor" href="#27-如何选择合适的空间权重矩阵"></a> 2.7 如何选择合适的空间权重矩阵？</h3>
<p>尽管二进制的空间邻近权值矩阵并非适用于所有的空间计量经济模型，但是，处于某些情况下的实用性，空间统计学家在构建空间计量模型时的<b>首选</b>就是从二进制的<b>邻近矩阵</b>开始的。</p>
<p>一般是先从空间邻近的最基本二进制矩阵开始，<b>逐步</b>选择确定空间权值矩阵。</p>
<p>关于各种权值矩阵的选择，没有现成的理论根据，一般可考虑空间计量模型对各种空间权值矩阵的适用程度，检验估计结果对权值矩阵的敏感性，最终的依据实际上就是结果的客观性和科学性。</p>
<h3 id="28-空间权重矩阵的标准化处理"><a class="markdownIt-Anchor" href="#28-空间权重矩阵的标准化处理"></a> 2.8 空间权重矩阵的标准化处理</h3>
<ul>
<li>在上述的空间权重矩阵中，我们不难发现初步的空间权重矩阵仍存在以下问题：
<ul>
<li>所有的空间权重矩阵总是对称矩阵，这明显与现实情况不符合。例如，现实中存在的空间效应是单向的或非双向对称的（模仿效应)：</li>
<li>空间权重矩阵中各元素无法显示出其邻居空间作用的相对强弱。【邻近程度】</li>
</ul>
</li>
<li>为了解决上述问题，我们对空间权重矩阵进行行标准化处理，具体公式如下（行标准化处理）：</li>
</ul>
\begin{eqnarray}
	w_{n,ij} = \frac{W_{n,ij}}{\sum_{j=1}^n W_{n,ij}}	\notag
\end{eqnarray}

<p>上述的二元邻近矩阵的标准化处理：</p>
\begin{eqnarray}
	W_{ij} = \left(
	\begin{matrix}
		0 & 1/3 & 1/3 & 1/3 & 0 & 0 \\
		1/2 & 0 & 1/2 & 0 & 0 & 0 \\
		1/4 & 1/4 & 0 & 0 & 1/4 & 1/4 \\
		1/2 & 0 & 0 & 0 & 1/2 & 0 \\
		0 & 0 & 1/3 & 1/3 & 0 & 1/3 \\
		0 & 0 & 1/2 & 0 & 1/2 & 0
	\end{matrix}
	\right) \notag
\end{eqnarray}

<ul>
<li>标准化处理的好处在于，如果将行标准化矩阵 $ W $ 乘 $ x $ ，则可以得到每个区域邻居的平均值。</li>
<li>将矩阵标准化后，由于每行元素之和均为1，这意味着区域 $ i $ 所受其邻居的影响之和一定等于区域 $ j $ 所受其邻居的影响之和（任何 $ i\neq j $ ）；此假设可能过强。</li>
</ul>
<h2 id="3-空间自相关检验"><a class="markdownIt-Anchor" href="#3-空间自相关检验"></a> 3. 空间自相关检验</h2>
<p>在确定是否使用空间计量方法时，需要判断数据是否存在空间依赖性。如果不存在，则用标准的计量方法即可；如果存在，则可使用空间计量方法。（并非理论上的判断，而是统计意义上的判断）</p>
<p><b>“空间自相关”可以理解为位置相近的区域具有相似的变量取值</b>。如果高值与高值集聚在一起，低值与低值集聚在一起，则为“正空间自相关”；反之，如果高值与低值相邻，则为“负空间自相关”;如果高值与低值完全随机地分布，则不存在空间自相关。</p>
<p>目前常用来考察数据空间自相关的指标为<b>莫兰指数I</b>和<b>吉尔里指数C</b>，其中<u>莫兰指数是最常用的</u>。</p>
<h3 id="31-全局莫兰指数"><a class="markdownIt-Anchor" href="#31-全局莫兰指数"></a> 3.1 全局莫兰指数</h3>
\begin{eqnarray}
	I = \frac{\sum_{i=1}^n\sum_{j=1}^n w_{ij}(x_i-\bar x)(x_j - \bar x)}{S^2\sum_{i=1}^n\sum_{j=1}^n w_{ij}}	\notag\\
	I = \frac{\sum_{i=1}^n\sum_{j=1}^n w_{ij}(x_i-\bar x)(x_j - \bar x)}{\sum_{i=1}^n (x_i - \bar x)}	\notag
\end{eqnarray}

<p>莫兰指数I的取值一般介于-1到1之间，大于0表示正自相关，即高值与高值相邻、低值与低值相邻;小于0表示负自相关，即高值与低值相邻。一般来说，正自相关比负自相关更常见。<u>如果莫兰指数I接近于0，则表明空间分布是随机的，不存在空间自相关</u>。<b>全局莫兰指数可以视为观测值与其空间滞后(观测值周围邻居数据的加权平均)的相关系数</b>。</p>
<h3 id="32-局部莫兰指数"><a class="markdownIt-Anchor" href="#32-局部莫兰指数"></a> 3.2 局部莫兰指数</h3>
<p>全局莫兰指数只能从整体上把握数据的空间自相关性，并不能对某个区域的空间集聚性进行识别。因此，还需要借助局部莫兰指数来解决该问题。</p>
\begin{eqnarray}
	I_i = \frac{x_i - \bar x }{S^2} \sum_{j=1}^n w_{ij} ( x_j-\bar x)	\notag
\end{eqnarray}

<p>如果指数为正，表示区域i的高（低）值都是被周围的高（低）值所包围；如果指数为负，则表示区域i的高（低）被周围低（高）值所包围。</p>
<h3 id="33-局部莫兰散点图"><a class="markdownIt-Anchor" href="#33-局部莫兰散点图"></a> 3.3 （局部）莫兰散点图</h3>
<div align='center'>
  <img src='/../../images/%E7%A9%BA%E9%97%B4%E8%AE%A1%E9%87%8F%E7%BB%8F%E6%B5%8E%E5%AD%A6%E4%B8%8Estata%E5%AE%9E%E6%93%8D/image-20221110163536947.png' width=500px>
</div>
<p>该图共分为四个象限：其中第一、第三象限表达的是局部莫兰指数大于0；第二象限表达的是低高集聚，第四象限表达的是高低集聚——似乎可以判断是虹吸效应还是集聚效应？</p>
<h3 id="34-其他指数"><a class="markdownIt-Anchor" href="#34-其他指数"></a> 3.4 其他指数</h3>
<p>吉尔里指数：</p>
\begin{eqnarray}
	C = \frac{(n-1)\sum_{i=1}^n \sum_{j=1}^n w_{ij}(x_i-x_j)^2}{2(\sum_{i=1}^n\sum_{j=1}^n w_{ij})[\sum_{i=1}^n(x_i - \bar x )^2]}	\notag
\end{eqnarray}

<p>吉尔里指数C的取值一般介于0到2之间(2不是严格上限），大于1表示负相关，等于1表示不相关，而小于1表示正相关。吉尔里指数C比莫兰指数I对局部空间自相关更为敏感。</p>
<p>局部Getis-Ord指数</p>
\begin{eqnarray}
	G = \frac{\sum_{j\neq i} w_{ij}x_j}{\sum_{j\neq i} x_j}	\notag
\end{eqnarray}

<p>局部Getis-Ord指数与局部莫兰指数相似。</p>
<h2 id="4-空间计量模型的设定与选择"><a class="markdownIt-Anchor" href="#4-空间计量模型的设定与选择"></a> 4. 空间计量模型的设定与选择</h2>
<h3 id="41-常见的空间计量模型"><a class="markdownIt-Anchor" href="#41-常见的空间计量模型"></a> 4.1 常见的空间计量模型</h3>
<h4 id="411-空间自回归模型sar"><a class="markdownIt-Anchor" href="#411-空间自回归模型sar"></a> 4.1.1 空间自回归模型（SAR）</h4>
<p>在空间自回归模型（空间滞后模型）中，被解释变量间存在较强的空间依赖性，进而邻地被解释变量会通过空间传导机制影响到本地的被解释变量。（技术扩散)</p>
\begin{eqnarray}
	y = \lambda Wy + X\beta + \varepsilon	\notag
\end{eqnarray}

<p>$ X $  为 $ n\times k $ 解释变量矩阵， $ y $  为被解释变量矩阵，$ W $ 为空间权重矩阵， $ \lambda $ 为空间自回归系数，$ \beta $ 为待估参数矩阵， $ \varepsilon $ 为随机扰动项矩阵。</p>
<h4 id="412-空间杜宾模型sdm比较通用"><a class="markdownIt-Anchor" href="#412-空间杜宾模型sdm比较通用"></a> 4.1.2 空间杜宾模型（SDM）——比较通用？</h4>
<p>在空间杜宾模型中，本地被解释变量的变化不仅受到本地解释变量的影响，还受到邻地解释变量的影响。（知识溢出效应)</p>
\begin{eqnarray}
	y = X\beta + WX\delta + \varepsilon	\notag
\end{eqnarray}

<p>$ X $  为 $ n\times k $ 解释变量矩阵， $ y $  为被解释变量矩阵，$ W $ 为空间权重矩阵， $ \delta $ 为空间项归系数，$ \beta $ 为待估参数矩阵， $ \varepsilon $ 为随机扰动项矩阵。</p>
<h4 id="413-空间误差模型sem"><a class="markdownIt-Anchor" href="#413-空间误差模型sem"></a> 4.1.3 空间误差模型（SEM）</h4>
<p>在空间误差模型中，邻地误差项会通过空间传导机制影响本地的被解释变量的变化。该模型主要适用于研究机构或地区之间的相互作用因所处的相对位置不同而存在差异的情况。此外，<b>遗漏变量和不正确的函数形式也会造成空间误差效应</b>。</p>
\begin{eqnarray}
	&&y = X\beta + \mu \notag\\
	&&\mu = \rho W \mu + \varepsilon ,\varepsilon\sim N(0,\sigma^2 I_n)	\notag
\end{eqnarray}

<p>$ X $ 为 $ n\times k $ 解释变量矩阵， $ y $ 为被解释变量矩阵， $ W $ 为空间权重矩阵， $ \mu $ 为误差项矩阵， $ \rho $ 为空间项系数， $ \beta $ 为待估参数矩阵， $ \varepsilon $ 为随机扰动项矩阵。</p>
<p>总结：<b>以上三个模型的特点是，空间滞后项分别体现在被解释变量、解释变量、误差项里面</b>。</p>
<h4 id="414-一般的空间计量模型sarar针对截面数据"><a class="markdownIt-Anchor" href="#414-一般的空间计量模型sarar针对截面数据"></a> 4.1.4 一般的空间计量模型（SARAR，针对截面数据）</h4>
<p>一般性的空间计量模型是将空间自回归模型、空间杜宾模型和空间误差模型结合，构建的具有一般化推广的空间计量模型。（没有解释变量的滞后项，因为它实质上是一个控制变量，不影响）</p>
\begin{eqnarray}
	y &=& \lambda Wy + X\beta + \mu	\notag\\
	\mu &=& \rho M \mu + \varepsilon, \varepsilon\sim N(0,\sigma^2 I_n)	\notag
\end{eqnarray}

<p>$ X $ 为 $ n\times k $ 解释变量矩阵 ，$ y $ 为被解释变量矩阵，$ W $ 、 $ М $ 为空间权重矩阵， $ \mu $ 为误差项矩阵，$ \rho $ 为空间项系数， $ \beta $ 为待估参数矩阵， $ \varepsilon $ 为随机扰动项矩阵。</p>
<h3 id="42-如何设定合适的空间模型"><a class="markdownIt-Anchor" href="#42-如何设定合适的空间模型"></a> 4.2 如何设定合适的空间模型？</h3>
<p>对一般性空间计量模型进行拉格朗日乘数检验(LM检验)、稳健的拉格朗日乘数检验(RLM检验)和似然比检验（LR检验)，根据检验结果来选择合适的模型。</p>
<table>
<thead>
<tr>
<th>检验</th>
<th>H0</th>
<th>H1</th>
<th>结果</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>LM-error</td>
<td>$ \rho=0 $</td>
<td>$ \rho\neq 0 $</td>
<td>拒绝H0，使用SEM</td>
<td>均拒绝H0，执行稳健性检验</td>
</tr>
<tr>
<td>LM-lag</td>
<td>$ \lambda=0 $</td>
<td>$ \lambda\neq 0 $</td>
<td>拒绝H0，使用SAR</td>
<td></td>
</tr>
<tr>
<td>RLM-error</td>
<td>$ \rho=0 $</td>
<td>$ \rho\neq 0 $</td>
<td>拒绝H0，使用SEM</td>
<td>均拒绝H0，选择更显著的模型</td>
</tr>
<tr>
<td>RLM-lag</td>
<td>$ \lambda=0 $</td>
<td>$ \lambda\neq 0 $</td>
<td>拒绝H0，使用</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="421-含内生解释变量的sarar模型"><a class="markdownIt-Anchor" href="#421-含内生解释变量的sarar模型"></a> 4.2.1 含内生解释变量的SARAR模型</h4>
\begin{eqnarray}
	y = \lambda Wy + X\beta + Z\delta + u	\notag
\end{eqnarray}

<p>其中 $ Z $ 由内生解释变量组成，扰动项 $ u $ 的生成过程依然为</p>
\begin{eqnarray}
	u = \rho M \mu + \varepsilon, \varepsilon\sim N(0,\sigma^2 I_n)	\notag
\end{eqnarray}

<p>假设 $ X $ 之外，还有不在方程中的外生变量 $ X _ e $ ，定义 $ X_f\equiv (X, X _ e )$ 。定义工具变量矩阵 $ H $ 为 $ { X _ f,WX _ f ,\cdots,W ^ q X _ f, MX _ f, MWX _ f, \cdots, MW ^ q X _ f } $ 中线性独立的列向量，则可以进行GS2SLS估计。</p>
<p>Stata代码示例：</p>
<pre class="line-numbers language-stata" data-language="stata"><code class="language-stata"><span class="token command keyword">spivreg</span> crime <span class="token punctuation">(</span>income <span class="token operator">=</span> hoval<span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token function">id</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token function">dlamt</span><span class="token punctuation">(</span>w1<span class="token punctuation">)</span> <span class="token function">elmat</span><span class="token punctuation">(</span>w1<span class="token punctuation">)</span> het nolog<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>代码中<code>het</code>表示使用异方差稳健性的标准误。</p>
<h4 id="422-空间面板模型"><a class="markdownIt-Anchor" href="#422-空间面板模型"></a> 4.2.2 空间面板模型</h4>
\begin{eqnarray}
	y_{it} &=& \tau y_{i,t-1} + \rho w_i^\prime y_t + x_{ij}^\prime \beta + d_i^\prime X_t\delta + \mu_i+\varepsilon_{it}	\notag\\
	\varepsilon_{it} &=& \lambda m_i^\prime \varepsilon_t + \nu_{it}	\notag
\end{eqnarray}

<ul>
<li>如果 $ \lambda=0 $ ，则为空间杜宾模型（SDM）</li>
<li>如果 $ \lambda=0 $ 且 $ \delta=0 $ ，则为空间自回归模型（SAR）</li>
<li>如果 $ \tau = 0 $ 且 $ \delta=0 $ ，则为空间自相关模型（SAC）——即上文的SARAR</li>
<li>如果 $ \tau=\rho=0 $ 且 $ \delta=0 $ ，则为空间误差模型（SEM）</li>
</ul>
<p>模型检验：</p>
<table>
<thead>
<tr>
<th>检验</th>
<th>H0</th>
<th>H1</th>
<th>结果</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>LM-error</td>
<td>$ \rho=0 $</td>
<td>$ \rho\neq 0 $</td>
<td>拒绝H0,使用SAR</td>
<td>均拒绝H0，执行稳健性检验</td>
</tr>
<tr>
<td>LM-lag</td>
<td>$ \lambda=0 $</td>
<td>$ \lambda\neq 0 $</td>
<td>拒绝H0,使用</td>
<td></td>
</tr>
<tr>
<td>RLM-error</td>
<td>$ \rho=0 $</td>
<td>$ \rho\neq 0 $</td>
<td>拒绝H0,使用SAR</td>
<td>均拒绝H0，选择更显著的模型</td>
</tr>
<tr>
<td>RLM-lag</td>
<td>$ \lambda=0 $</td>
<td>$ \lambda\neq 0 $</td>
<td>拒绝H0,使用</td>
<td></td>
</tr>
<tr>
<td>LR(SDM与SAR)</td>
<td>$ \lambda\neq 0$</td>
<td>$ \lambda=0 $</td>
<td>拒绝H0,使用SDM</td>
<td>均拒绝H0，使用SDM</td>
</tr>
<tr>
<td>LR(SDM与SEM)</td>
<td>$ \rho\neq0 $</td>
<td>$ \rho= 0 $</td>
<td>拒绝H0,使用SDM</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="43-空间面板模型估计步骤"><a class="markdownIt-Anchor" href="#43-空间面板模型估计步骤"></a> 4.3 空间面板模型估计步骤</h3>
<ul>
<li>事前检验:莫兰检验、LM检验和RLM检验(判断模型是否需要引入空间滞后项)</li>
<li>事后检验:LR检验、Wald检验（此二者检验模型是否可以退化为其他模型）、Hausman检验（确定模型使用固定效应还是随机效应）【判断模型是否为最优的，选择合适模型】</li>
<li>模型回归:选择变量合适形式，正式进行回归</li>
<li>效应分解:根据实际需求，进行空间效应分解(如果设置的是空间杜宾模型，就需要对解释变量的空间效应进行分解，由于解释变量空间项存在反馈效应，从而使得估计系数不能准确反映出溢出效应，需要用偏微分的方式对效应分解为直接效应与间接效应)</li>
<li>稳健性检验/内生性检验/异方差检验</li>
<li>根据后续检验调整模型，直至模型稳健正确为止</li>
</ul>
<div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  
  </pre></div>
<pre class="mermaid">flowchart LR
空间计量模型 --- a["截面空间计量模型"] & b["空间面板模型"]
a --- a1["构建空间矩阵"] & a2["莫兰指数检验"] & a3["LM检验和R-LM检验"] & a4["模型正式回归"] & a5["空间效应分解"]
a1 --- a11["地理二元邻近矩阵"] & a12["地理反距离矩阵"] & a13["经济距离矩阵"]
a2 --- 全局莫兰指数 & 局部莫兰指数
a3 --- a30["根据Anselin（2004）判别进行模型选择\nAnselin和Florax (1995)提出了如下判别准则:\n 如果在空间依赖性的检验中发现LMLAG较之LMERR \n 在统计上更加显著且R-LMLAG显著而R-LMERR不显著，\n则可以断定适合的模型是空间滞后模型;\n相反，如果LMERR比LMLAG在统计上更加显著，\n且R-LMERR显著而R-LMLAG不显著，\n则可以断走空间误差模型是恰当的模型。"]---a31["SAR"] & a32["SEM"] & a33["SDM"]
a5 --- a51["如果为SDM，由于存在反馈效应，要对空间效应进行分解\n（直接效应、间接效应；短期效应、长期效应）"]
b --- b1["构建空间矩阵"] & b2["事前检验"] & b3["事后检验"] & b4["模型正式回归"] & b5["空间效应分解"]
b1 --- b11["地理二元邻近矩阵"] & b12["地理反距离矩阵"] & b13["经济距离矩阵"]
b2 --- b21["莫兰指数检验"] & b22["LM检验和R-Lm检验"] & b23["Hausman检验"]
b21 --- b211["全局莫兰指数"] & b212["局部莫兰指数"]
b22 --- b221["SAR"] & b222["SEM"] & b223["SDM"]
b23 --- 确定使用固定效应还是随机效应
b3 --- b31["LR检验"] & b32["Wald检验（效果同LR，一般要汇报此结果）"]
b31 --- b311["查看之前建立的模型是否会退化"] & b312["在固定效应的基础上确定每个个体固定效应\n还是时间固定效应，还是双向固定效应"]
b5 --- b51["如果为SDM，由于存在反馈效应，要对空间效应进行分解\n（直接效应、间接效应；短期效应、长期效应）"] & b52["若确定为其他模型，无需进行分解空间效应"]</pre>
<h2 id="5-空间计量的案例与软件操作"><a class="markdownIt-Anchor" href="#5-空间计量的案例与软件操作"></a> 5. 空间计量的案例与软件操作</h2>
<p>以下为Stata操作实例，更多例子可以参考陈强老师的书。</p>
<pre class="line-numbers language-stata" data-language="stata"><code class="language-stata"><span class="token command keyword">findit</span> sg162<span class="token operator">/</span><span class="token operator">/</span>查找s系列台令并安装<span class="token punctuation">(</span>空间计量命令<span class="token punctuation">)</span>
			<span class="token comment">*spmat:生成空间权重矩阵</span>
			<span class="token comment">*spatwmat:定义空间权重矩阵</span>
			<span class="token comment">*spatgsa:全局空间自相关检验</span>
			<span class="token comment">*spatlsa:局部空间自相关检验</span>
			<span class="token comment">*spatcorr:考察空间自相关指标对临界值的依赖性</span>
			<span class="token comment">*spatdiag:针对OLS回归結果，考察是否存在空间效应</span>
			<span class="token comment">*spatreg:估计空间滞后模型和空间误差模型</span>
			<span class="token comment">*xsmle:估计空间面板模型(额外安装，help xsmle)</span>
<span class="token comment">*===============================(第1步)将shp文件转化为dta文件==============================</span>

<span class="token command keyword">shp2dta</span> using china.shp<span class="token punctuation">,</span> <span class="token function">database</span><span class="token punctuation">(</span>china_base<span class="token punctuation">)</span> <span class="token function">coordinates</span><span class="token punctuation">(</span>china_coord<span class="token punctuation">)</span> <span class="token function">genid</span><span class="token punctuation">(</span>ID<span class="token punctuation">)</span> replace  

<span class="token comment">*===============================(第2步)建立空间权重矩阵，并将矩阵导入dta中====================</span>
<span class="token comment">*用stata代码只能构建二元邻近矩阵和地理距离矩阵</span>

<span class="token command keyword">use</span> china_base.dta<span class="token punctuation">,</span><span class="token keyword">clear</span>

<span class="token command keyword">drop</span> <span class="token keyword">if</span> ID<span class="token operator">></span><span class="token number">34</span> <span class="token comment">//剔除南海诸岛(南海诸岛没有坐标)</span>

<span class="token command keyword">spmat</span> contiguity W1 using china_coord<span class="token punctuation">,</span> <span class="token function">id</span><span class="token punctuation">(</span>ID<span class="token punctuation">)</span> replace <span class="token comment">//建立0-1矩阵（未标准化）；这样构建的矩阵会存在内存里，为了后续能重复使用，下面将其存为dta文件 </span>

<span class="token command keyword">spmat</span> save W1 using W1.txt<span class="token punctuation">,</span>replace <span class="token comment">//将0-1矩阵导入txt文件中</span>
<span class="token command keyword">spmat</span> export W1 using <span class="token string-literal"><span class="token string">"W1.txt"</span></span><span class="token punctuation">,</span> noid replace
<span class="token command keyword">insheet</span> using <span class="token string-literal"><span class="token string">"W1.txt"</span></span><span class="token punctuation">,</span><span class="token function">delim</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">" "</span></span><span class="token punctuation">)</span> <span class="token keyword">clear</span>
<span class="token command keyword">drop</span> <span class="token keyword">in</span> <span class="token number">1</span>
<span class="token command keyword">save</span> <span class="token string-literal"><span class="token string">"W1.dta"</span></span><span class="token punctuation">,</span> replace <span class="token comment">//将0-1矩阵转化为dta文件</span>


<span class="token command keyword">use</span> china_base.dta<span class="token punctuation">,</span><span class="token keyword">clear</span>
<span class="token command keyword">drop</span> <span class="token keyword">if</span> ID<span class="token operator">></span><span class="token number">34</span> <span class="token comment">//删除南海诸岛(南海诸岛没有坐标)</span>

<span class="token command keyword">spmat</span> idistance W2 center1 center2<span class="token punctuation">,</span> <span class="token function">id</span><span class="token punctuation">(</span>ID<span class="token punctuation">)</span> <span class="token function">dfunction</span><span class="token punctuation">(</span>euclidean<span class="token punctuation">)</span> replace <span class="token comment">//建立地理反距离矩阵（未标准化）；这样构建的矩阵会存在内存里，为了后续能重复使用，下面将其存为dta文件</span>

<span class="token command keyword">spmat</span> save W2 using W2.txt<span class="token punctuation">,</span>replace <span class="token comment">//将地理反距离矩阵导入txt文件中</span>
<span class="token command keyword">spmat</span> export W2 using <span class="token string-literal"><span class="token string">"W2.txt"</span></span><span class="token punctuation">,</span> noid replace
<span class="token command keyword">insheeting</span> using <span class="token string-literal"><span class="token string">"W2.txt"</span></span><span class="token punctuation">,</span> <span class="token function">delim</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">" "</span></span><span class="token punctuation">)</span> <span class="token keyword">clear</span>
<span class="token command keyword">drop</span> <span class="token keyword">in</span> <span class="token number">1</span>
<span class="token command keyword">save</span> <span class="token string-literal"><span class="token string">"W2.dta"</span></span><span class="token punctuation">,</span> replace <span class="token comment">//将地理反距离矩阵转化为dta文件</span>


<span class="token comment">*===============================(第3步)截面数据：进行空间自相关分析====================</span>
<span class="token command keyword">clear</span> 
<span class="token command keyword">cd</span> <span class="token operator">/</span>Users<span class="token operator">/</span>juncker<span class="token operator">/</span>Desktop<span class="token operator">/</span>空间计量经济学<span class="token operator">/</span>cq<span class="token operator">/</span>
<span class="token comment">//陈强的案例</span>
<span class="token command keyword">spatwmat</span> using columbusswm.dta<span class="token punctuation">,</span>name <span class="token punctuation">(</span>W<span class="token punctuation">)</span>  
<span class="token comment">//定义权重矩阵</span>
<span class="token command keyword">matrix</span> list W <span class="token comment">//查着所建矩阵</span>

<span class="token command keyword">spatwmat</span> using columbusswm.dta<span class="token punctuation">,</span> <span class="token function">name</span><span class="token punctuation">(</span>Ws<span class="token punctuation">)</span> standardize 
<span class="token comment">//定义标准化矩阵，standardize 是标准化的意思</span>
<span class="token command keyword">matrix</span> list Ws <span class="token comment">//查看所建矩阵</span>

<span class="token command keyword">use</span> columbusdata.dta<span class="token punctuation">,</span><span class="token keyword">clear</span> <span class="token comment">//导入数据</span>

<span class="token command keyword">spatgsa</span> crim<span class="token punctuation">,</span><span class="token function">weights</span><span class="token punctuation">(</span>W<span class="token punctuation">)</span> moran <span class="token comment">//计算全局莫兰指数(非标准化矩阵)</span>
<span class="token command keyword">spatgsa</span> crim<span class="token punctuation">,</span><span class="token function">weights</span><span class="token punctuation">(</span>Ws<span class="token punctuation">)</span> moran <span class="token comment">//计算全局莫兰指数(标准化矩阵)</span>

<span class="token command keyword">spatlsa</span> crim<span class="token punctuation">,</span><span class="token function">weights</span><span class="token punctuation">(</span>W<span class="token punctuation">)</span> moran <span class="token comment">//计算局部莫兰指数(非标准化矩阵)</span>
<span class="token command keyword">spatlsa</span> crim<span class="token punctuation">,</span><span class="token function">weights</span><span class="token punctuation">(</span>Ws<span class="token punctuation">)</span> moran <span class="token comment">//计算局部莫兰指数(标准化矩阵)</span>

<span class="token command keyword">spatlsa</span> crim<span class="token punctuation">,</span><span class="token function">weights</span><span class="token punctuation">(</span>Ws<span class="token punctuation">)</span> moran <span class="token function">graph</span><span class="token punctuation">(</span>moran<span class="token punctuation">)</span> <span class="token function">symbol</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token function">id</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token comment">//画莫兰散点图(必须使用标准化矩阵)</span>

<span class="token comment">*===============================(第4步)截面数据：LM检验==============================</span>
<span class="token command keyword">reg</span> crime hoval income <span class="token comment">//0LS国归</span>

<span class="token command keyword">spatdiag</span><span class="token punctuation">,</span><span class="token function">weights</span><span class="token punctuation">(</span>Ws<span class="token punctuation">)</span> <span class="token comment">//LM检验</span>

<span class="token comment">*===============================(第5a步)截面数据：简单模型回归========================</span>
<span class="token command keyword">spatwmat</span> using columbusswm.dta<span class="token punctuation">,</span>name <span class="token punctuation">(</span>Ws<span class="token punctuation">)</span> <span class="token function">eigenval</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span> <span class="token comment">//计算矩阵的特征向量值</span>

<span class="token command keyword">spatreg</span> crime hoval income<span class="token punctuation">,</span><span class="token function">weights</span><span class="token punctuation">(</span>Ws<span class="token punctuation">)</span> <span class="token function">eigenval</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span> <span class="token function">model</span><span class="token punctuation">(</span>lag<span class="token punctuation">)</span> nolog <span class="token comment">//空间自回归模型</span>

<span class="token command keyword">spatreg</span> crime hoval income<span class="token punctuation">,</span><span class="token function">weights</span><span class="token punctuation">(</span>Ws<span class="token punctuation">)</span> <span class="token function">eigenval</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span> <span class="token function">model</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> nolog <span class="token comment">//空间误差模型</span>

<span class="token command keyword">spregsdm</span> crime hoval income <span class="token punctuation">[</span>aweight <span class="token operator">=</span> hoval<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">wmfile</span><span class="token punctuation">(</span>columbusswm<span class="token punctuation">)</span> 
<span class="token comment">//空间杜宾模型(无法指定单个变量的空间滞后项) ;spregsdm命令需要自己安装：help spregsdm</span>

<span class="token command keyword">spregress</span> crime hoval income<span class="token punctuation">,</span>gs2sls <span class="token function">ivarlag</span><span class="token punctuation">(</span>W<span class="token punctuation">:</span>hoval<span class="token punctuation">)</span> <span class="token comment">//空间杜宾模型(没研究明白)</span>

<span class="token comment">*===============================(第5b步)截面数据：复杂模型回归========================</span>
<span class="token comment">* SARAR模型估计【复合模型】</span>
<span class="token comment">*findit sppack //安装命令包</span>

<span class="token command keyword">use</span> columbusswm.dta<span class="token punctuation">,</span><span class="token keyword">clear</span>

<span class="token command keyword">spmat</span> dta w1 a1<span class="token operator">-</span>a49<span class="token punctuation">,</span><span class="token function">normalize</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span> replace <span class="token comment">//建立spmat格式的矩阵</span>

<span class="token command keyword">use</span> columbusdata.dta<span class="token punctuation">,</span><span class="token keyword">clear</span>

<span class="token command keyword">spreg</span> ml crime hoval income<span class="token punctuation">,</span><span class="token function">id</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token function">dlmat</span><span class="token punctuation">(</span>w1<span class="token punctuation">)</span> <span class="token function">elmat</span><span class="token punctuation">(</span>w1<span class="token punctuation">)</span> nolog <span class="token comment">// SARAR模型(MLE估计法)</span>

<span class="token command keyword">spreg</span> gs2sls crime hoval income<span class="token punctuation">,</span><span class="token function">id</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token function">dlmat</span><span class="token punctuation">(</span>w1<span class="token punctuation">)</span> <span class="token function">elmat</span><span class="token punctuation">(</span>w1<span class="token punctuation">)</span> het nolog <span class="token comment">//SARAR模型(gs2s1s估计法)</span>

<span class="token comment">*含内生解释变量的SARAR模型</span>
<span class="token command keyword">spivreg</span> crime <span class="token punctuation">(</span>income<span class="token operator">=</span>hoval<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">id</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token function">dlmat</span><span class="token punctuation">(</span>w1<span class="token punctuation">)</span> <span class="token function">elmat</span><span class="token punctuation">(</span>w1<span class="token punctuation">)</span> het nolog <span class="token comment">//hoval为income的工具变量</span>


<span class="token comment">*===============================面板数据(论文片段):模型回归==========================</span>
<span class="token comment">*属于人家私人数据，不可用，仅供研究思路</span>
<span class="token command keyword">clear</span>
<span class="token comment">*cd 长三角地级市shp</span>
<span class="token command keyword">set</span> matsize <span class="token number">5000</span>    <span class="token comment">//设立了5000*5000空的权重矩阵</span>
<span class="token command keyword">use</span> W2.dta
<span class="token command keyword">spcs2xt</span> v1<span class="token operator">-</span>v41<span class="token punctuation">,</span><span class="token function">matrix</span><span class="token punctuation">(</span>W2d<span class="token punctuation">)</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span>  <span class="token comment">//将W2导入到空的权重矩阵中，并增加一个时间项</span>
<span class="token command keyword">spatwmat</span> using W2dxt<span class="token punctuation">,</span> <span class="token function">name</span><span class="token punctuation">(</span>Wdlm<span class="token punctuation">)</span> standardize <span class="token comment">//建立空间面板矩阵，并将其标准化</span>

<span class="token comment">*导入数据</span>
<span class="token command keyword">clear</span>
<span class="token comment">*cd C:\User8\lenovo\Desktop\师门\文章\第一篇论文(空间计量)</span>
<span class="token command keyword">use</span> 数据.dta
<span class="token command keyword">xtset</span> ID year <span class="token comment">//声明面板数据</span>
<span class="token command keyword">drop</span> <span class="token keyword">if</span> year<span class="token operator">-</span><span class="token operator">=</span><span class="token number">2000</span> <span class="token comment">//将样本时间限制到2001-2018</span>

<span class="token comment">*LM检验</span>
<span class="token command keyword">cd</span> 长三角地級市shp <span class="token comment">//导入矩阵文件</span>

<span class="token command keyword">spatwmat</span> using W2.dta<span class="token punctuation">,</span> <span class="token function">name</span><span class="token punctuation">(</span>Wd<span class="token punctuation">)</span> standardize

<span class="token command keyword">reg</span> Innewprod_reven high_res Inactgdp_per phyca forinv_ratio sciexp_ratio <span class="token comment">/*
*/</span> lntechservindus_person industry2_gdp industry3_gdp
<span class="token command keyword">spatdiag</span><span class="token punctuation">,</span> weights <span class="token punctuation">(</span>Wdlm<span class="token punctuation">)</span>

<span class="token comment">*Hausman检验</span>
<span class="token command keyword">xsmle</span> Innewprod_reven high_res Inactgdp_per phyca forinv_ratio sciexp_ratio <span class="token comment">/*
*/</span> Intechservindus_person industry2_gdp industry3_gdp<span class="token punctuation">,</span> <span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>high_res<span class="token punctuation">)</span> <span class="token function">wmat</span><span class="token punctuation">(</span>Wd<span class="token punctuation">)</span> fe nolog 
<span class="token command keyword">est</span> store sdm_fe <span class="token comment">//固定效应</span>

<span class="token command keyword">xsmle</span> Innewprod_reven high_res Inactgdip_per phyca forinv_ratio sciexp_ratio <span class="token comment">/*
*/</span> Intechservindus_person industry2_gdp industry3_gdp<span class="token punctuation">,</span> <span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>high_res<span class="token punctuation">)</span> <span class="token function">what</span><span class="token punctuation">(</span>Wd<span class="token punctuation">)</span> re nolog 
<span class="token command keyword">est</span> store sdm_re <span class="token comment">//随机效应</span>

<span class="token comment">* durbin后面是选择项，默认选择所有解释变量</span>

<span class="token command keyword">hausman</span> sdm_fe sdm_re <span class="token comment">//接受固定效应</span>

<span class="token comment">*另一种HAUSMAN检验方法〈爱丁堡大学)</span>
<span class="token command keyword">xsmle</span> Innewprod_reven high_res lnactgdp_per phyca forinv_ratio sciexp_ratio <span class="token comment">/*
*/</span> Intechservindus_person industry2_gdp industry3_gdp<span class="token punctuation">,</span><span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>high_res<span class="token punctuation">)</span> wmat <span class="token punctuation">(</span>Wd<span class="token punctuation">)</span> hausman nolog 


<span class="token comment">*LR检验</span>
	<span class="token comment">*SDM VS SAR VS SEM</span>
<span class="token command keyword">xsmle</span> innewprod reven high res inactgdp per phyca forinv ratio sciexp ratio <span class="token comment">/*
*/</span> intechservindus_person industry2_gdp industry3_gdp<span class="token punctuation">,</span><span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>high_res<span class="token punctuation">)</span> wmat <span class="token punctuation">(</span>id<span class="token punctuation">)</span> fe nolog noetfects 
<span class="token command keyword">est</span> store sdm_a

<span class="token command keyword">xsmle</span> innewprod_reven high_res Inactgdp_per phyca forinv_ratio sciexp_ratio <span class="token comment">/*
*/</span> intechservindus_person industry2_gdp industry3_gdp<span class="token punctuation">,</span> <span class="token function">model</span><span class="token punctuation">(</span>sar<span class="token punctuation">)</span> wmat <span class="token punctuation">(</span>wd<span class="token punctuation">)</span> fe nolog noeffects 
<span class="token command keyword">est</span> store sar_a

<span class="token command keyword">xsmle</span> innewprod_reven high_res inactgdp_per phyca forinv_ratio sciexp_ratio <span class="token comment">/*
*/</span> Intechservindus person industry2_gdp industry3_gdp<span class="token punctuation">,</span><span class="token function">model</span><span class="token punctuation">(</span>sem<span class="token punctuation">)</span> emat <span class="token punctuation">(</span>wd<span class="token punctuation">)</span> fe nolog noeffects
<span class="token command keyword">est</span> store sem_a

<span class="token command keyword">lrtest</span> sdm_a sar_a <span class="token comment">//比软SDM与SAR模型(原假设:SDM模型可以退化为SAR/SEM)</span>
<span class="token command keyword">lrtest</span> sdm_a sem_a <span class="token comment">//比较SDM与SEM模型</span>


<span class="token comment">*个体固定效应VS时间固定效应VS双固定效应</span>
<span class="token command keyword">xsmle</span> innewprod_reven high_res inactgdp_per phyca forinv_ratio sciexp_ratio <span class="token comment">/*
*/</span> intechservindus_person industry2_gdp industry3_gdp<span class="token punctuation">,</span><span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>high_res<span class="token punctuation">)</span> wmat <span class="token punctuation">(</span>id<span class="token punctuation">)</span> fe <span class="token function">type</span><span class="token punctuation">(</span>ind<span class="token punctuation">)</span> nolog noetfects 
<span class="token command keyword">est</span> store sdm_ind

<span class="token command keyword">xsmle</span> innewprod_reven high_res inactgdp_per phyca forinv_ratio sciexp_ratio <span class="token comment">/*
*/</span> Intechservindus person industry2_gdp industry3_gdp<span class="token punctuation">,</span><span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>high_res<span class="token punctuation">)</span> wmat <span class="token punctuation">(</span>id<span class="token punctuation">)</span> fe <span class="token function">type</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span> nolog noetfects 
<span class="token command keyword">est</span> store sdm_time

<span class="token command keyword">xsmle</span> Innewprod_reven high_res inactgdp_per phyca forinv_ratio sciexp_ratio <span class="token comment">/*
*/</span> Intechservindus person industry2_gdp industry3_gdp<span class="token punctuation">,</span><span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>high_res<span class="token punctuation">)</span> wmat <span class="token punctuation">(</span>id<span class="token punctuation">)</span> fe <span class="token function">type</span><span class="token punctuation">(</span>both<span class="token punctuation">)</span> nolog noetfects 
<span class="token command keyword">est</span> store sdm_both
 
<span class="token command keyword">lrtest</span> sdm_both sdm_ind<span class="token punctuation">,</span><span class="token function">df</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token command keyword">lrtest</span> sdm_both sdm_time<span class="token punctuation">,</span><span class="token function">df</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>


<span class="token comment">*Wald检验</span>
<span class="token command keyword">xsmle</span> Innewprod_reven high_res Inactgdp_per phyca forinv_ratio sciexp_ratio <span class="token comment">/*
*/</span> Intechservindus_person industry2_gdp industry3_gdp<span class="token punctuation">,</span><span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>high_res<span class="token punctuation">)</span> wmat <span class="token punctuation">(</span>wd<span class="token punctuation">)</span> robust nolog noeffects fe <span class="token function">type</span><span class="token punctuation">(</span>both<span class="token punctuation">)</span>
<span class="token command keyword">test</span> <span class="token punctuation">[</span>Wx<span class="token punctuation">]</span>high_res<span class="token operator">=</span><span class="token number">0</span> <span class="token comment">//比较SDM与SAR</span>
<span class="token command keyword">testnl</span>（<span class="token punctuation">[</span>Wx<span class="token punctuation">]</span>high_res<span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">[</span>Spatial<span class="token punctuation">]</span>rho<span class="token operator">*</span><span class="token punctuation">[</span>Main<span class="token punctuation">]</span>high_res） <span class="token comment">//比较SDM与SEM</span>


<span class="token comment">*最終模型画归结果(SDM模型)</span>
<span class="token command keyword">xsmle</span> Innewprod_reven high_res lnactgdp_per phyca forinv_ratio sciexp_ratio <span class="token comment">/*
*/</span> Intechservindus_person industry2_gdp industry3_gdp<span class="token punctuation">,</span> <span class="token function">wmat</span><span class="token punctuation">(</span>Wd<span class="token punctuation">)</span> <span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>high_res<span class="token punctuation">)</span> <span class="token function">dlag</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> robust fe noeffects nolog

<span class="token comment">*解释：dlag设置被解释变量的空间动态滞后项。dlag(1)时间上滞后一期； dlag(2)空间上滞后一期； dlag(3)时间和空间上都滞后一期</span>

<span class="token comment">*===============================面板数据〈陈强 书上片段):模型回归==========================</span>
<span class="token command keyword">net</span> install xsmle<span class="token punctuation">,</span>all <span class="token function">from</span><span class="token punctuation">(</span>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>www.econometrics.it<span class="token operator">/</span>stata<span class="token punctuation">)</span>

<span class="token command keyword">use</span> product.dta<span class="token punctuation">,</span><span class="token keyword">clear</span> <span class="token comment">//导入数据</span>

<span class="token command keyword">xtset</span> state year

<span class="token command keyword">gen</span> lngsp<span class="token operator">=</span><span class="token function">log</span><span class="token punctuation">(</span>gsp<span class="token punctuation">)</span>
<span class="token command keyword">gen</span> lnpcap<span class="token operator">=</span><span class="token function">log</span><span class="token punctuation">(</span>pcap<span class="token punctuation">)</span>
<span class="token command keyword">gen</span> lnpc<span class="token operator">=</span><span class="token function">log</span><span class="token punctuation">(</span>pc<span class="token punctuation">)</span>
<span class="token command keyword">gen</span> lnemp<span class="token operator">=</span><span class="token function">log</span><span class="token punctuation">(</span>emp<span class="token punctuation">)</span>

<span class="token command keyword">spmat</span> use usaww using usaww.spmat<span class="token punctuation">,</span>replace <span class="token comment">//根据数据文件usaww.spmat生成空间权重矩阵"usaww"(未标准化)</span>

<span class="token command keyword">xsmle</span> lngsp lnpcap lnpc lnemp unemp<span class="token punctuation">,</span> <span class="token function">wmat</span><span class="token punctuation">(</span>usaww<span class="token punctuation">)</span> <span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> nolog robust nolog
<span class="token comment">//使用聚类文件的标准误估计随机效应的SDM模型</span>

<span class="token command keyword">xsmle</span> lngsp lnpcap lnpc lnemp unemp<span class="token punctuation">,</span> <span class="token function">wmat</span><span class="token punctuation">(</span>usaww<span class="token punctuation">)</span> <span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>lnemp<span class="token punctuation">)</span> robust nolog noeffects <span class="token comment">//SDM模型(指定空间滞后项）</span>

<span class="token command keyword">qui</span> xsmle lngsp lnpcap lnpc lnemp unemp<span class="token punctuation">,</span> wmat <span class="token punctuation">(</span>usaww<span class="token punctuation">)</span> <span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>lnemp<span class="token punctuation">)</span> nolog noeffects
<span class="token command keyword">est</span> sto re

<span class="token command keyword">qui</span> xsmle lngsp lnpcap lnpc lnemp unemp<span class="token punctuation">,</span> wmat <span class="token punctuation">(</span>usaww<span class="token punctuation">)</span> <span class="token function">model</span><span class="token punctuation">(</span>sdm<span class="token punctuation">)</span> <span class="token function">durbin</span><span class="token punctuation">(</span>lnemp<span class="token punctuation">)</span> nolog noeffects fe
<span class="token command keyword">est</span> sto fe

<span class="token comment">*究竟应使用随机效应还是固定效应模型，须进行豪斯曼检验。</span>
<span class="token command keyword">hausman</span> fe re

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="6-参考资料"><a class="markdownIt-Anchor" href="#6-参考资料"></a> 6. 参考资料</h2>
<ol>
<li>
<p>Anselin L,Bera AK.Spatial Dependence in Linear Regression Models with an Introduction to Spatial Econometrics[J]. revue déconomie industrielle, 1998.</p>
</li>
<li>
<p>JL Gallo, C Ertur. Exploratory spatial data analysis of the distribution of regional per capita GDP in Europe, 1980-1995[J]. Papers in Regional Science, 2003.</p>
</li>
<li>
<p>Baltagi B H, Song SH, Jung B C, et al. Testing for serial correlation, spatial autocorrelation and random effects using panel data[J]. Journal of Econometrics, 2007, 140(1):5-51.</p>
</li>
<li>
<p>Gomez MH. Spatial Econometrics Methods using Stata. 2017.</p>
</li>
<li>
<p>吴玉鸣.空间计量经济模型在省域研发与创新中的应用研究[J].数量经济技术经济研究,2006(05):74-85+130.</p>
</li>
<li>
<p>杨海生,陈少凌,周永章.地方政府竞争与环境政策一来自中国省份数据的证据[J].南方经济,2008(06):15-30.</p>
</li>
<li>
<p>盛彦文,骆华松,宋金平,赵金丽,张学波.中国东部沿海五大城市群创新效率、影响因素及空间溢出效应[J].地理研究,2020,39(02):257-271.</p>
</li>
<li>
<p>Elhorst JP . Spatial econometrics: from cross-sectional data to spatial panels[M]. Physica-Verlag HD, 2014.本书相关资料下载:<a target="_blank" rel="noopener" href="https://spatial-panels.com/software/">https://spatial-panels.com/software/</a></p>
</li>
<li>
<p>Anselin L. Spatial Econometrics: Methods and Models[M]. Springer Netherlands, 1988.</p>
</li>
<li>
<p>林光平，龙志和.空间经济计量[М].科学出版社, 2014.</p>
</li>
</ol>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="tags/stata/">stata</a><a class="post-meta__tags" href="tags/%E7%A9%BA%E9%97%B4%E8%AE%A1%E9%87%8F/">空间计量</a><a class="post-meta__tags" href="tags/%E7%A9%BA%E9%97%B4%E6%9D%83%E9%87%8D%E7%9F%A9%E9%98%B5/">空间权重矩阵</a><a class="post-meta__tags" href="tags/%E7%A9%BA%E9%97%B4%E8%87%AA%E7%9B%B8%E5%85%B3%E6%A3%80%E9%AA%8C/">空间自相关检验</a><a class="post-meta__tags" href="tags/SAR/">SAR</a><a class="post-meta__tags" href="tags/SEM/">SEM</a><a class="post-meta__tags" href="tags/SDM/">SDM</a><a class="post-meta__tags" href="tags/SARAR/">SARAR</a></div><div class="post_share"><div class="social-share" data-image="/private_img/banner2.gif" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/private_img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/private_img/wechat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/private_img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/private_img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="4140170368.html" title="如何从知网下载期刊论文封面及目录页？"><img class="cover" src="/private_img/banner2.gif" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">如何从知网下载期刊论文封面及目录页？</div></div></a></div><div class="next-post pull-right"><a href="375150708.html" title="史塔威尔-亚洲大趋势"><img class="cover" src="/private_img/banner2.gif" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">史塔威尔-亚洲大趋势</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="1837523341.html" title="stata笔记"><img class="cover" src="/private_img/banner2.gif" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-15</div><div class="title">stata笔记</div></div></a></div><div><a href="2914285830.html" title="商品价格和银行危机"><img class="cover" src="/private_img/banner2.gif" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-03</div><div class="title">商品价格和银行危机</div></div></a></div><div><a href="767402338.html" title="微观计量经济学"><img class="cover" src="/private_img/banner2.gif" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-25</div><div class="title">微观计量经济学</div></div></a></div><div><a href="4165288499.html" title="金融依赖性和增长的关系"><img class="cover" src="/private_img/banner2.gif" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-28</div><div class="title">金融依赖性和增长的关系</div></div></a></div><div><a href="4065962852.html" title="龙治铭量化分析课件"><img class="cover" src="/private_img/banner2.gif" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-23</div><div class="title">龙治铭量化分析课件</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="../private_img/yuyingnan.jpg" onerror="this.onerror=null;this.src='../img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">揭晓</div><div class="author-info__description">随手写一写，揭晓这世界</div></div><a id="card-info-btn" href="/"><i class="fas fa-home"></i><span>回到首页</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%A9%BA%E9%97%B4%E8%AE%A1%E9%87%8F%E7%BB%8F%E6%B5%8E%E5%AD%A6%E6%A6%82%E8%BF%B0"><span class="toc-text"> 1. 空间计量经济学概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%A9%BA%E9%97%B4%E6%9D%83%E9%87%8D%E7%9F%A9%E9%98%B5%E7%9A%84%E8%AE%BE%E5%AE%9A%E4%B8%8E%E9%80%89%E6%8B%A9"><span class="toc-text"> 2. 空间权重矩阵的设定与选择</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E9%82%BB%E8%BF%91%E5%85%B3%E7%B3%BB"><span class="toc-text"> 2.1 邻近关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-%E5%9C%B0%E7%90%86%E8%B7%9D%E7%A6%BB"><span class="toc-text"> 2.2 地理距离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-%E7%BB%8F%E6%B5%8E%E8%B7%9D%E7%A6%BB"><span class="toc-text"> 2.3 经济距离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-%E4%BA%A7%E4%B8%9A%E8%B7%9D%E7%A6%BB"><span class="toc-text"> 2.4 产业距离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25-%E6%8A%80%E6%9C%AF%E8%B7%9D%E7%A6%BB%E6%AF%94%E8%BE%83%E5%A4%8D%E6%9D%82"><span class="toc-text"> 2.5 技术距离（比较复杂）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26-%E7%BB%BC%E5%90%88%E8%B7%9D%E7%A6%BB"><span class="toc-text"> 2.6 综合距离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27-%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%E5%90%88%E9%80%82%E7%9A%84%E7%A9%BA%E9%97%B4%E6%9D%83%E9%87%8D%E7%9F%A9%E9%98%B5"><span class="toc-text"> 2.7 如何选择合适的空间权重矩阵？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28-%E7%A9%BA%E9%97%B4%E6%9D%83%E9%87%8D%E7%9F%A9%E9%98%B5%E7%9A%84%E6%A0%87%E5%87%86%E5%8C%96%E5%A4%84%E7%90%86"><span class="toc-text"> 2.8 空间权重矩阵的标准化处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E7%A9%BA%E9%97%B4%E8%87%AA%E7%9B%B8%E5%85%B3%E6%A3%80%E9%AA%8C"><span class="toc-text"> 3. 空间自相关检验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#31-%E5%85%A8%E5%B1%80%E8%8E%AB%E5%85%B0%E6%8C%87%E6%95%B0"><span class="toc-text"> 3.1 全局莫兰指数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32-%E5%B1%80%E9%83%A8%E8%8E%AB%E5%85%B0%E6%8C%87%E6%95%B0"><span class="toc-text"> 3.2 局部莫兰指数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33-%E5%B1%80%E9%83%A8%E8%8E%AB%E5%85%B0%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="toc-text"> 3.3 （局部）莫兰散点图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34-%E5%85%B6%E4%BB%96%E6%8C%87%E6%95%B0"><span class="toc-text"> 3.4 其他指数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E7%A9%BA%E9%97%B4%E8%AE%A1%E9%87%8F%E6%A8%A1%E5%9E%8B%E7%9A%84%E8%AE%BE%E5%AE%9A%E4%B8%8E%E9%80%89%E6%8B%A9"><span class="toc-text"> 4. 空间计量模型的设定与选择</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#41-%E5%B8%B8%E8%A7%81%E7%9A%84%E7%A9%BA%E9%97%B4%E8%AE%A1%E9%87%8F%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 4.1 常见的空间计量模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#411-%E7%A9%BA%E9%97%B4%E8%87%AA%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8Bsar"><span class="toc-text"> 4.1.1 空间自回归模型（SAR）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#412-%E7%A9%BA%E9%97%B4%E6%9D%9C%E5%AE%BE%E6%A8%A1%E5%9E%8Bsdm%E6%AF%94%E8%BE%83%E9%80%9A%E7%94%A8"><span class="toc-text"> 4.1.2 空间杜宾模型（SDM）——比较通用？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#413-%E7%A9%BA%E9%97%B4%E8%AF%AF%E5%B7%AE%E6%A8%A1%E5%9E%8Bsem"><span class="toc-text"> 4.1.3 空间误差模型（SEM）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#414-%E4%B8%80%E8%88%AC%E7%9A%84%E7%A9%BA%E9%97%B4%E8%AE%A1%E9%87%8F%E6%A8%A1%E5%9E%8Bsarar%E9%92%88%E5%AF%B9%E6%88%AA%E9%9D%A2%E6%95%B0%E6%8D%AE"><span class="toc-text"> 4.1.4 一般的空间计量模型（SARAR，针对截面数据）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#42-%E5%A6%82%E4%BD%95%E8%AE%BE%E5%AE%9A%E5%90%88%E9%80%82%E7%9A%84%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 4.2 如何设定合适的空间模型？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#421-%E5%90%AB%E5%86%85%E7%94%9F%E8%A7%A3%E9%87%8A%E5%8F%98%E9%87%8F%E7%9A%84sarar%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 4.2.1 含内生解释变量的SARAR模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#422-%E7%A9%BA%E9%97%B4%E9%9D%A2%E6%9D%BF%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 4.2.2 空间面板模型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#43-%E7%A9%BA%E9%97%B4%E9%9D%A2%E6%9D%BF%E6%A8%A1%E5%9E%8B%E4%BC%B0%E8%AE%A1%E6%AD%A5%E9%AA%A4"><span class="toc-text"> 4.3 空间面板模型估计步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%A9%BA%E9%97%B4%E8%AE%A1%E9%87%8F%E7%9A%84%E6%A1%88%E4%BE%8B%E4%B8%8E%E8%BD%AF%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-text"> 5. 空间计量的案例与软件操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-text"> 6. 参考资料</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="../329702610.html" title="博士论文手稿v2">博士论文手稿v2</a><time datetime="2023-08-18T12:11:33.316Z" title="更新于 2023-08-18 20:11:33">2023-08-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="../2511924152.html" title="博士论文手稿">博士论文手稿</a><time datetime="2023-08-18T12:08:55.278Z" title="更新于 2023-08-18 20:08:55">2023-08-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="../865972098.html" title="马克思之后的马克思经济学">马克思之后的马克思经济学</a><time datetime="2023-08-16T10:11:03.906Z" title="更新于 2023-08-16 18:11:03">2023-08-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="../1344037003.html" title="《高峰文集》读书笔记">《高峰文集》读书笔记</a><time datetime="2023-08-16T01:44:37.606Z" title="更新于 2023-08-16 09:44:37">2023-08-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="../788356124.html" title="Excel上的一些骚操作">Excel上的一些骚操作</a><time datetime="2023-08-14T14:31:24.297Z" title="更新于 2023-08-14 22:31:24">2023-08-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="../4292746748.html" title="计算31省区市的实际GDP增长率">计算31省区市的实际GDP增长率</a><time datetime="2023-08-11T08:44:46.477Z" title="更新于 2023-08-11 16:44:46">2023-08-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="../2385863533.html" title="生产力与生产关系">生产力与生产关系</a><time datetime="2023-08-08T02:07:00.835Z" title="更新于 2023-08-08 10:07:00">2023-08-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="../3666905482.html" title="马恩全集摘抄">马恩全集摘抄</a><time datetime="2023-08-07T09:36:28.948Z" title="更新于 2023-08-07 17:36:28">2023-08-07</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/private_img/banner2.gif')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 揭晓</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="js/utils.js"></script><script src="js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
  }

  btf.addModeChange('mermaid', runMermaid)

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>function loadDisqus () {
  const disqus_config = function () {
    this.page.url = 'https://dhndzwxj.github.io/1302782253.html'
    this.page.identifier = ''
    this.page.title = '空间计量经济学与stata实操'
  }

  const disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  btf.addModeChange('disqus', disqusReset)

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Disqus' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script type='text/javascript' src='https://ajax.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js'></script><script id="dsq-count-scr" src="//https-www-dhndzwxj-top.disqus.com/count.js" async></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="../js/search/local-search.js"></script></div></div></body></html>